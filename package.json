{
  "name": "purple-warlock",
  "version": "0.0.1",
  "description": "Purple Warlock",
  "license": "UNLICENSED",
  "private": true,
  "devDependencies": {
    "cross-env": "^7.0.2",
    "dotenv-cli": "^3.1.0",
    "npm-run-all": "^4.1.5",
    "wighawag_newsh": "^0.0.5"
  },
  "workspaces": {
    "packages": [
      "contracts",
      "webapp",
      "subgraph",
      "server",
      "web3w",
      "web3w-torus",
      "web3w-walletconnect"
    ],
    "nohoist": [
      "purple-warlock-subgraph/@graphprotocol/graph-ts",
      "purple-warlock-subgraph/@graphprotocol/graph-ts/**",
      "purple-warlock-contracts/@nomiclabs/buidler",
      "purple-warlock-contracts/@nomiclabs/buidler/**",
      "purple-warlock-contracts/buidler-deploy",
      "purple-warlock-contracts/buidler-ethers-v5",
      "purple-warlock-webapp/prettier-plugin-svelte"
    ]
  },
  "scripts": {
    "postinstall": "node ./.setup.js",

    "// externals : Setup external services locally (ethereum node, thegraph)": "",
    "externals:down": "docker-compose down -v",
    "shell:server": "newsh \"npm run server\"",
    "docker-compose:up": "dotenv -e .env -e contracts/.env --  docker-compose up",
    "externals": "run-p -l docker-compose:up",
    "shell:externals": "newsh \"npm run externals\"",
    
    "// subgraphs : generate and deploy local subgraph": "",
    "subgraph:setup": "npm --prefix subgraph run local:setup",
    "subgraph:deploy": "npm --prefix subgraph run local:deploy ../contracts/deployments/localhost_1337",
    
    "// contracts : deploy smart contracts on local ethereum node": "",
    "contracts:deploy": "npm --prefix contracts run local:deploy -- --export ../webapp/src/contracts/development.json",
    "shell:contracts:deploy": "newsh \"npm run contracts:deploy\"",
    "seed": "dotenv -- npm --prefix contracts run local:seed",
    
    "// webapp : run local webapp in dev mode": "",
    "webapp": "dotenv -- npm --prefix webapp run dev",
    "shell:webapp": "newsh \"npm run webapp\"",
    
    "// dev : local development setup": "This setup external service, setup subgraph and deploy it on the local graph-node, deploy the contracts and seed it",
    "dev": "npm-run-all -l externals:down --parallel webapp externals --sequential subgraph:setup contracts:deploy subgraph:deploy seed",
    "shell:dev": "npm-run-all -l externals:down --parallel shell:webapp shell:externals --sequential subgraph:setup contracts:deploy subgraph:deploy seed",
    "shell:dev:no-webapp": "npm-run-all -l externals:down --parallel shell:externals --sequential subgraph:setup contracts:deploy subgraph:deploy seed",
    
    "// STAGING : deploy on staging": "",
    "staging:subgraph:deploy": "dotenv -e .env.staging -e .env -- npm --prefix subgraph run kovan:deploy ../contracts/deployments/kovan",
    "staging:webapp:build": "dotenv -e .env.staging -e .env -- npm --prefix webapp run build",
    "staging:seed": "dotenv -e .env.staging -e .env -- npm --prefix contracts run kovan:run scripts/seed.js",
    
    "// SERVE Webapp ": "",
    "webapp:build": "dotenv -- npm --prefix webapp run build",
    "webapp:serve": "npm --prefix webapp run start --",
    "webapp:build:serve": "run-s webapp:build webapp:serve",
    
    "// PRODUCTION : build on mainnet": "",
    "production:webapp:build": "dotenv -e .env.production -e .env -- npm --prefix webapp run build"
  }
}
